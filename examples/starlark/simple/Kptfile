apiVersion: kpt.dev/v1alpha2
kind: Kptfile
metadata:
  name: example
pipeline:
  mutators:
    - image: gcr.io/kpt-fn/starlark:unstable
      config:
        apiVersion: fn.kpt.dev/v1alpha1
        kind: StarlarkRun
        metadata:
          name: set-namespace-to-prod
        source: |
          # set the namespace on all resources
          def setnamespace(resources, namespace):
            for resource in resources:
              # mutate the resource
              resource["metadata"]["namespace"] = namespace
          setnamespace(ctx.resource_list["items"], "prod")
